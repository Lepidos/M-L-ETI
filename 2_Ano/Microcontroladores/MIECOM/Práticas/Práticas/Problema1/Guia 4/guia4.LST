A51 MACRO ASSEMBLER  GUIA4                                                                10/30/2013 20:08:05 PAGE     1


MACRO ASSEMBLER A51 V8.02b
OBJECT MODULE PLACED IN guia4.OBJ
ASSEMBLER INVOKED BY: C:\Keil\C51\BIN\A51.EXE guia4.a51 SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

                       1     ;#include <89C51Rx2.inc>
                       2     ;       INICIO DE PROGRAMA
                       3                     NAME MAIN
                       4     
                       5                     EXTRN   CODE    (ENVIAR_RS232, RECEBER_RS232, CONFIG_RS232)
                       6     
----                   7                     CSEG    AT      0H
0000 802E              8                     JMP             MAIN
                       9     
----                  10                     CSEG    AT      30H
0030                  11     MAIN:
0030 120000   F       12                     CALL    CONFIG_RS232    ; configura a porta de serie(flags, bourate, etc)
0033 75904F           13                     MOV             P1,#4Fh                 ; envia 4Fh('7') para a porta de se
                             rie(P1)
0036 7C00             14                     MOV     R4,#0                   ; inicializa o contador a 0
0038 90004C           15                     MOV     DPTR,#MENSAGEM  ; DPTR toma o valor do apontador de MENSAGEM, ou se
                             ja o valor da primeira posição da string
003B                  16     MAINLOOP:
003B EC               17             MOV             A,R4                    ; 'A' toma o valor de R4
003C 93               18                     MOVC    A,@A+DPTR               ; Mover para 'A' o byte relativo á posição 
                             = A+DPTR(será sempre o valor da primeira posição da string
003D 120000   F       19                     CALL    ENVIAR_RS232    ; Envia o byte para a porta de serie 
0040 0C               20                     INC             R4                              ; incrementa 1 a R4 (R4 = R
                             4 +1
0041 BC02F7           21                     CJNE    R4,#MSGLEN,MAINLOOP             ;compara R4 e #MSGLEN(tamanho da me
                             nsagem) e salta para MAINLOOP enquanto for diferente
0044                  22     MAINLOOP2:
0044 120000   F       23                     CALL    RECEBER_RS232   ; Recebe os bytes da porta de serie 
0047 120000   F       24                     CALL    ENVIAR_RS232    ; Envia o byte para a porta de serie
004A 80F8             25                     JMP             MAINLOOP2               ; Salta sempre para MAINLOOPS2 (cic
                             lo infinito)
                      26     
004C                  27     MENSAGEM:
004C 3037             28                     DB      "07"            ; A mensagem a enviar será "07"
  0002                29     MSGLEN  EQU $-MENSAGEM  ; MSGLEN = $(posição de memoria de fim de mensagem) - MENSAGEM (pos
                             ição de memoria da primeira letra da mensagem)
                      30     END             ;FIM DE PROGRAMA
A51 MACRO ASSEMBLER  GUIA4                                                                10/30/2013 20:08:05 PAGE     2

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

CONFIG_RS232 . . .  C ADDR   -----       EXT
ENVIAR_RS232 . . .  C ADDR   -----       EXT
MAIN . . . . . . .  C ADDR   0030H   A   
MAINLOOP . . . . .  C ADDR   003BH   A   
MAINLOOP2. . . . .  C ADDR   0044H   A   
MENSAGEM . . . . .  C ADDR   004CH   A   
MSGLEN . . . . . .  N NUMB   0002H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
RECEBER_RS232. . .  C ADDR   -----       EXT


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
