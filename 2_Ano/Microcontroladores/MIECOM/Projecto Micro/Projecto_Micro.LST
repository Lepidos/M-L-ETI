A51 MACRO ASSEMBLER  PROJECTO_MICRO                                                       01/18/2013 14:29:18 PAGE     1


MACRO ASSEMBLER A51 V8.02a
OBJECT MODULE PLACED IN Projecto_Micro.OBJ
ASSEMBLER INVOKED BY: C:\Keil\C51\BIN\A51.EXE Projecto_Micro.a51 NOMOD51 SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

                       1     ;#include <89C51Rx2.inc>
                +1     2  +1 $save     
                +1   191  +1 $restore 
                     192     
                     193     
  0040               194     TXPTR EQU 040h 
                     195     
----                 196             CSEG AT 00H
0000 806E            197                     JMP INICIO
                     198     
----                 199             CSEG AT 070H
                     200     
0070                 201     INICIO:
                     202                     
0070 7800            203                     MOV R0,#00H ; R0 CONTEM O TERMINO DOS BITS A ENVIAR (POSIÇÃO)    
0072 7940            204                     MOV R1,#TXPTR     ; MOVE 40H PARA R1
                     205                     
0074 7590FF          206                     MOV     P1,#0FFH                         
0077 7580FF          207                     MOV P0,#0FFH
                     208     
                     209     ;---------------------------------------------------------------------------------
                     210     ;CONFIGURAÇÃO DA PORTA SERIE
                     211     
007A                 212     CONFIG:
007A 75CDFF          213             MOV TH2, #0FFh 
007D 75CCD9          214             MOV TL2, #0D9h 
0080 75CAD9          215             MOV RCAP2L, #0D9h
0083 75CBFF          216             MOV RCAP2H, #0FFh 
0086 75C834          217             MOV T2CON, #034h ;ja activa o timer2
0089 759850          218             MOV SCON, #50h ;8-bit, 1 stop bit, REN enable
                     219     
                     220     ;---------------------------------------------------------------------------------
                     221     ;LER TECLA PREMIDA
                     222     
008C                 223     LER_TECLA:      
008C E580            224                             MOV A,P0           
008E F5F0            225                             MOV B,A                
0090 64FF            226                             XRL A,#11111111b   ; VERIFICAR SE FOI PREMIDA UMA TECLA            
                                  
0092 60F8            227                             JZ LER_TECLA       ; SE NAO FOI VOLTAMOS A LER
0094 8000            228                             JMP DESC_TECLA     ; SE FOR ZERO PROCEDEMOS Á SUA DESCODIFICAÇÃO
                     229     
                     230     ;--------------------------------------------------------------------------------          
                                          
                     231     ;DESCODIFICAÇÃO DAS TECLAS PREMIDAS
                     232     
0096                 233     DESC_TECLA:     
                     234                                                              
0096 E5F0            235                             MOV A,B
0098 64F5            236                             XRL A,#0F5H      ; VERIFICAR SE É A TECLA ZERO (11110101)       
009A 7D00            237                             MOV R5,#0
009C 6058            238                             JZ AINDA_TECLA
                     239                             
009E E5F0            240                             MOV A,B
00A0 64BB            241                             XRL A,#0BBH     
00A2 7D01            242                             MOV R5,#1
00A4 6050            243                             JZ AINDA_TECLA
                     244                                 
A51 MACRO ASSEMBLER  PROJECTO_MICRO                                                       01/18/2013 14:29:18 PAGE     2

00A6 E5F0            245                             MOV A,B
00A8 64BD            246                             XRL A,#0BDH     
00AA 7D02            247                             MOV R5,#2
00AC 6048            248                             JZ AINDA_TECLA
                     249     
00AE E5F0            250                             MOV A,B
00B0 64BE            251                             XRL A,#0BEH     
00B2 7D03            252                             MOV R5,#3
00B4 6040            253                             JZ AINDA_TECLA 
                     254     
00B6 E5F0            255                             MOV A,B
00B8 64DB            256                             XRL A,#0DBH     
00BA 7D04            257                             MOV R5,#4
00BC 6038            258                             JZ AINDA_TECLA
                     259     
00BE E5F0            260                             MOV A,B
00C0 64DD            261                             XRL A,#0DDH     
00C2 7D05            262                             MOV R5,#5
00C4 6030            263                             JZ AINDA_TECLA
                     264     
00C6 E5F0            265                             MOV A,B
00C8 64DE            266                             XRL A,#0DEH     
00CA 7D06            267                             MOV R5,#6
00CC 6028            268                             JZ AINDA_TECLA 
                     269     
00CE E5F0            270                             MOV A,B
00D0 64EB            271                             XRL A,#0EBH     
00D2 7D07            272                             MOV R5,#7
00D4 6020            273                             JZ AINDA_TECLA 
                     274     
00D6 E5F0            275                             MOV A,B
00D8 64ED            276                             XRL A,#0EDH     
00DA 7D08            277                             MOV R5,#8
00DC 6018            278                             JZ AINDA_TECLA 
                     279     
00DE E5F0            280                             MOV A,B
00E0 64EE            281                             XRL A,#0EEH      
00E2 7D09            282                             MOV R5,#9
00E4 6010            283                             JZ AINDA_TECLA  
                     284     
00E6 E5F0            285                             MOV A,B
00E8 64F3            286                             XRL A,#0F3H      
00EA 6006            287                             JZ ASTERISTICO  
                     288     
00EC E5F0            289                             MOV A,B
00EE 64F6            290                             XRL A,#0F6H      
00F0 6002            291                             JZ CARDINAL      
                     292     ;--------------------------------------------------------------------------
00F2                 293     ASTERISTICO:
00F2 800D            294                     JMP LIMPAR
                     295     
00F4                 296     CARDINAL:
00F4 8013            297                     JMP CONFIRMAR
                     298     
                     299     ;-------------------------------------------------------------------------------
                     300      ;VERIFICA SE A TECLA AINDA ESTÁ A SER PREMIDA
                     301     
00F6                 302     AINDA_TECLA:                    
                     303                                          
00F6 74FF            304                     LOOP:   MOV A,#0FFh             
00F8 6580            305                                     XRL A,P0                        ; VERIFICAR SE AINDA ESTAMO
                             S A PREMIR A TECLA
00FA 7011            306                                     JNZ LIGA_DISPLAY        ; SE NAO FOR 0, SIGNIFICA QUE AINDA
                              ESTAMOS A PREMIR ENTAO LIGAMOS DISPLAY
00FC 7590FF          307                                     MOV P1,#0FFh            ; SE FOR 0 , JA NAO ESTAMOS A PREMI
                             R
A51 MACRO ASSEMBLER  PROJECTO_MICRO                                                       01/18/2013 14:29:18 PAGE     3

00FF 6018            308                                     JZ MOVER_MEM            ; COLOCAR EM MEMORIA A TECLA
                     309     ;--------------------------------------------------------------------------------
                     310     ;TECLAS ESPECIAIS (COMFIRMAR E LIMPAR)
                     311     
                     312     ; TECLA LIMPAR (*) -> LIMPAR TODAS AS TECLAS INTRODUZIDAS E GUARDADAS NA MEMORIA
0101                 313     LIMPAR:
0101 E500            314                     MOV A, 00H
0103 F7              315                     MOV @R1, A
0104 09              316                     INC R1
0105 D8FA            317                     DJNZ R0, LIMPAR
0107 0170            318                     JMP INICIO
                     319     
                     320     
                     321     ; TECLA CONFIRMAR (#) -> ENVIO DE TODAS AS TECLAS INTRODUZIDAS ANTERIORMENTE
0109                 322     CONFIRMAR: 
0109 7940            323                     MOV R1,#TXPTR     
010B 8012            324                     JMP ENVIAR_SERIE
                     325                     
                     326                     
                     327     ;-------------------------------------------------------------------------------
                     328     ;LIGA O NUMERO CORRESPONDENTE NO DISPLAY
010D                 329     LIGA_DISPLAY:
010D 7590FF          330                     MOV P1, #0FFH
0110 900100          331                     MOV DPTR, #NUM
0113 ED              332                     MOV A, R5
0114 93              333                     MOVC A, @A+DPTR
0115 F590            334                     MOV P1,A
0117 80DD            335                     JMP LOOP         
                     336                     
                     337     ;---------------------------------------------------------------------------------
                     338     ;COLOCA EM MEMORIA AS TECLA PREMIDAS
                     339     
0119                 340     MOVER_MEM:                                         
0119 ED              341                         MOV A,R5                    
011A F7              342                             MOV @R1,A               
011B 09              343                             INC R1
011C 08              344                             INC R0
011D 800D            345                             JMP NOVA_TECLA
                     346     ;------------------------------------------------------------------------------------
                     347     ;ENVIAR POR PORTA SERIE OS DIGITOS INSERIDOS 
                     348     
011F                 349     ENVIAR_SERIE:           
011F E7              350                                     MOV A,@R1                               
0120 09              351                                     INC R1                                  
0121 F599            352                                     MOV SBUF,A                          
0123 3099FD          353                                     JNB TI,$
0126 C299            354                                     CLR TI                                          
0128 D8F5            355                                     DJNZ R0, ENVIAR_SERIE   
012A 80DE            356                                     JMP FIM     
                     357                                     
                     358     ;------------------------------------------------------------------------------------------
                             -
                     359     ;LE TECLA SEGUINTE
012C                 360     NOVA_TECLA:
                     361                             
012C 7590FF          362                             MOV P1,#0FFH
012F 7580FF          363                             MOV P0,#0FFH             
0132 018C            364                             JMP LER_TECLA            
                     365     
                     366     ;------------------------------------------------------------------------------------------
                             -
0100                 367     ORG 100H
0100 0CCF5446        368     NUM: DB  0CH, 0CFH, 54H, 46H, 87H, 26H, 24H, 4FH, 04H, 06H
0104 8726244F                
0108 0406                    
                     369     
A51 MACRO ASSEMBLER  PROJECTO_MICRO                                                       01/18/2013 14:29:18 PAGE     4

                     370     
                     371     
010A                 372     FIM:
                     373             END
A51 MACRO ASSEMBLER  PROJECTO_MICRO                                                       01/18/2013 14:29:18 PAGE     5

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

AC . . . . . . . .  B ADDR   00D0H.6 A   
ACC. . . . . . . .  D ADDR   00E0H   A   
AINDA_TECLA. . . .  C ADDR   00F6H   A   
ASTERISTICO. . . .  C ADDR   00F2H   A   
AUXR . . . . . . .  D ADDR   008EH   A   
AUXR1. . . . . . .  D ADDR   00A2H   A   
B. . . . . . . . .  D ADDR   00F0H   A   
BDRCON . . . . . .  D ADDR   009BH   A   
BRL. . . . . . . .  D ADDR   009AH   A   
CARDINAL . . . . .  C ADDR   00F4H   A   
CCAP0H . . . . . .  D ADDR   00FAH   A   
CCAP0L . . . . . .  D ADDR   00EAH   A   
CCAP1H . . . . . .  D ADDR   00FBH   A   
CCAP1L . . . . . .  D ADDR   00EBH   A   
CCAP2H . . . . . .  D ADDR   00FCH   A   
CCAP2L . . . . . .  D ADDR   00ECH   A   
CCAP3H . . . . . .  D ADDR   00FDH   A   
CCAP3L . . . . . .  D ADDR   00EDH   A   
CCAP4H . . . . . .  D ADDR   00FEH   A   
CCAP4L . . . . . .  D ADDR   00EEH   A   
CCAPM0 . . . . . .  D ADDR   00DAH   A   
CCAPM1 . . . . . .  D ADDR   00DBH   A   
CCAPM2 . . . . . .  D ADDR   00DCH   A   
CCAPM3 . . . . . .  D ADDR   00DDH   A   
CCAPM4 . . . . . .  D ADDR   00DEH   A   
CCF0 . . . . . . .  D ADDR   00D8H   A   
CCF1 . . . . . . .  D ADDR   00D9H   A   
CCF2 . . . . . . .  D ADDR   00DAH   A   
CCF3 . . . . . . .  D ADDR   00DBH   A   
CCF4 . . . . . . .  D ADDR   00DCH   A   
CCON . . . . . . .  D ADDR   00D8H   A   
CF . . . . . . . .  D ADDR   00DFH   A   
CH . . . . . . . .  D ADDR   00F9H   A   
CKCON0 . . . . . .  D ADDR   008FH   A   
CKCON1 . . . . . .  D ADDR   00AFH   A   
CKRL . . . . . . .  D ADDR   0096H   A   
CL . . . . . . . .  D ADDR   00E9H   A   
CMOD . . . . . . .  D ADDR   00D9H   A   
CONFIG . . . . . .  C ADDR   007AH   A   
CONFIRMAR. . . . .  C ADDR   0109H   A   
CP_RL2 . . . . . .  B ADDR   00C8H.0 A   
CR . . . . . . . .  D ADDR   00DEH   A   
CY . . . . . . . .  B ADDR   00D0H.7 A   
C_T2 . . . . . . .  B ADDR   00C8H.1 A   
DESC_TECLA . . . .  C ADDR   0096H   A   
DPH. . . . . . . .  D ADDR   0083H   A   
DPL. . . . . . . .  D ADDR   0082H   A   
EA . . . . . . . .  B ADDR   00A8H.7 A   
EC . . . . . . . .  B ADDR   00A8H.6 A   
ENVIAR_SERIE . . .  C ADDR   011FH   A   
ES . . . . . . . .  B ADDR   00A8H.4 A   
ET0. . . . . . . .  B ADDR   00A8H.1 A   
ET1. . . . . . . .  B ADDR   00A8H.3 A   
ET2. . . . . . . .  B ADDR   00A8H.5 A   
EX0. . . . . . . .  B ADDR   00A8H.0 A   
EX1. . . . . . . .  B ADDR   00A8H.2 A   
EXEN2. . . . . . .  B ADDR   00C8H.3 A   
EXF2 . . . . . . .  B ADDR   00C8H.6 A   
F0 . . . . . . . .  B ADDR   00D0H.5 A   
FCON . . . . . . .  D ADDR   00D1H   A   
A51 MACRO ASSEMBLER  PROJECTO_MICRO                                                       01/18/2013 14:29:18 PAGE     6

FIM. . . . . . . .  C ADDR   010AH   A   
IE0. . . . . . . .  B ADDR   0088H.1 A   
IE1. . . . . . . .  B ADDR   0088H.3 A   
IEN0 . . . . . . .  D ADDR   00A8H   A   
IEN1 . . . . . . .  D ADDR   00B1H   A   
INICIO . . . . . .  C ADDR   0070H   A   
INT0 . . . . . . .  B ADDR   00B0H.2 A   
INT1 . . . . . . .  B ADDR   00B0H.3 A   
IPH0 . . . . . . .  D ADDR   00B7H   A   
IPL0 . . . . . . .  D ADDR   00B8H   A   
IPL1 . . . . . . .  D ADDR   00B2H   A   
IT0. . . . . . . .  B ADDR   0088H.0 A   
IT1. . . . . . . .  B ADDR   0088H.2 A   
KBE. . . . . . . .  D ADDR   009DH   A   
KBF. . . . . . . .  D ADDR   009EH   A   
KBLS . . . . . . .  D ADDR   009CH   A   
LER_TECLA. . . . .  C ADDR   008CH   A   
LIGA_DISPLAY . . .  C ADDR   010DH   A   
LIMPAR . . . . . .  C ADDR   0101H   A   
LOOP . . . . . . .  C ADDR   00F6H   A   
MOVER_MEM. . . . .  C ADDR   0119H   A   
NOVA_TECLA . . . .  C ADDR   012CH   A   
NUM. . . . . . . .  C ADDR   0100H   A   
OV . . . . . . . .  B ADDR   00D0H.2 A   
P. . . . . . . . .  B ADDR   00D0H.0 A   
P0 . . . . . . . .  D ADDR   0080H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . .  D ADDR   00B0H   A   
PCON . . . . . . .  D ADDR   0087H   A   
PPCL . . . . . . .  B ADDR   00B8H.6 A   
PSL. . . . . . . .  B ADDR   00B8H.4 A   
PSW. . . . . . . .  D ADDR   00D0H   A   
PT0L . . . . . . .  B ADDR   00B8H.1 A   
PT1L . . . . . . .  B ADDR   00B8H.3 A   
PT2L . . . . . . .  B ADDR   00B8H.5 A   
PX0L . . . . . . .  B ADDR   00B8H.0 A   
PX1L . . . . . . .  B ADDR   00B8H.2 A   
RB8. . . . . . . .  B ADDR   0098H.2 A   
RCAP2H . . . . . .  D ADDR   00CBH   A   
RCAP2L . . . . . .  D ADDR   00CAH   A   
RCLK . . . . . . .  B ADDR   00C8H.5 A   
RD . . . . . . . .  B ADDR   00B0H.7 A   
REN. . . . . . . .  B ADDR   0098H.4 A   
RI . . . . . . . .  B ADDR   0098H.0 A   
RS0. . . . . . . .  B ADDR   00D0H.3 A   
RS1. . . . . . . .  B ADDR   00D0H.4 A   
RXD. . . . . . . .  B ADDR   00B0H.0 A   
SADDR. . . . . . .  D ADDR   00A9H   A   
SADEN. . . . . . .  D ADDR   00B9H   A   
SBUF . . . . . . .  D ADDR   0099H   A   
SCON . . . . . . .  D ADDR   0098H   A   
SM0. . . . . . . .  B ADDR   0098H.7 A   
SM1. . . . . . . .  B ADDR   0098H.6 A   
SM2. . . . . . . .  B ADDR   0098H.5 A   
SP . . . . . . . .  D ADDR   0081H   A   
SPCON. . . . . . .  D ADDR   00C3H   A   
SPDAT. . . . . . .  D ADDR   00C5H   A   
SPSTA. . . . . . .  D ADDR   00C4H   A   
T0 . . . . . . . .  B ADDR   00B0H.4 A   
T1 . . . . . . . .  B ADDR   00B0H.5 A   
T2CON. . . . . . .  D ADDR   00C8H   A   
T2MOD. . . . . . .  D ADDR   00C9H   A   
TB8. . . . . . . .  B ADDR   0098H.3 A   
TCLK . . . . . . .  B ADDR   00C8H.4 A   
TCON . . . . . . .  D ADDR   0088H   A   
A51 MACRO ASSEMBLER  PROJECTO_MICRO                                                       01/18/2013 14:29:18 PAGE     7

TF0. . . . . . . .  B ADDR   0088H.5 A   
TF1. . . . . . . .  B ADDR   0088H.7 A   
TF2. . . . . . . .  B ADDR   00C8H.7 A   
TH0. . . . . . . .  D ADDR   008CH   A   
TH1. . . . . . . .  D ADDR   008DH   A   
TH2. . . . . . . .  D ADDR   00CDH   A   
TI . . . . . . . .  B ADDR   0098H.1 A   
TL0. . . . . . . .  D ADDR   008AH   A   
TL1. . . . . . . .  D ADDR   008BH   A   
TL2. . . . . . . .  D ADDR   00CCH   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . .  B ADDR   0088H.4 A   
TR1. . . . . . . .  B ADDR   0088H.6 A   
TR2. . . . . . . .  B ADDR   00C8H.2 A   
TXD. . . . . . . .  B ADDR   00B0H.1 A   
TXPTR. . . . . . .  N NUMB   0040H   A   
WDTPRG . . . . . .  D ADDR   00A7H   A   
WDTRST . . . . . .  D ADDR   00A6H   A   
WR . . . . . . . .  B ADDR   00B0H.6 A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
